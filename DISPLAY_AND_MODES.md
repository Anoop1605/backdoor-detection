# Display Messages and System Modes Documentation

This document explains the significance of the messages displayed on the Cyber Defense Dashboard and details the differences between Demo Mode and Production Mode.

## 1. Significance of Display Messages

The dashboard is divided into three main sections, each representing a different layer of the detection system:

### üì° Suricata IDS (Intrusion Detection System)
*   **What it is:** A signature-based network intrusion detection system.
*   **Significance:** Displays alerts based on known attack patterns (signatures).
*   **Messages:**
    *   **[ALERT]:** Indicates a high-priority security event matching a specific rule (e.g., "SSH Brute Force", "Malware Command & Control").
    *   **[FLOW/DNS/TLS]:** Represents standard network traffic metadata (protocol, source/destination IPs).
*   **Status Indicator:** Shows if the Suricata process is running and actively monitoring the network interface.

### üîç ANN Detection Engine (Artificial Neural Network)
*   **What it is:** A machine learning model trained to detect anomalies and zero-day attacks that might be missed by signature-based systems.
*   **Significance:** Analyzes network flow statistics (packet counts, bytes, flow duration) to classify traffic as "BENIGN" or "MALICIOUS".
*   **Messages:**
    *   **[+] Prediction: MALICIOUS Score=0.xxxx:** The model is highly confident that the traffic is malicious.
    *   **[+] Prediction: BENIGN Score=0.xxxx:** The traffic appears normal.
*   **Score:** A value between 0.0 and 1.0. Higher scores (> 0.5) indicate a higher probability of malicious activity.

### üõ° Hybrid Engine
*   **What it is:** A fusion engine that combines inputs from the Network (ANN) and Host monitoring (if available) to make a final decision.
*   **Significance:** Reduces false positives by correlating network anomalies with host-level events.
*   **Messages:**
    *   **[HYBRID] MALICIOUS Score=...:** The combined score from both network and host indicators suggests an attack.
    *   **Breakdown:** Often shows individual scores (e.g., `ANN=0.85, Host=0.20`) to explain the final decision.

### ‚öóÔ∏è Hybrid Fusion Formula
The Hybrid Engine uses a weighted formula to calculate the final threat score:

$$ \text{Final Score} = (\text{ANN} \times 0.5) + (\text{Host} \times 0.3) + (\text{Network} \times 0.2) $$

*   **ANN (50%):** The score from the Neural Network analyzing traffic flow.
*   **Host (30%):** A combined risk score from:
    *   **Process Analysis:** Checks for suspicious process names (e.g., `nc`, `bash -i`).
    *   **Connection Analysis:** Checks for non-standard ports.
    *   **Host ML:** An Isolation Forest model detecting anomalous process behavior (CPU/Memory usage).
*   **Network (20%):** Specifically checks for **Stepping Stone** attacks (relay behavior). If detected, this contributes significantly (0.8 score).

---

## 2. Demo Mode vs. Production Mode

| Feature | **Demo Mode** (`demo_mode.py`) | **Production Mode** (`app.py`) |
| :--- | :--- | :--- |
| **Data Source** | **Simulated.** Generated by a script (`demo_data_generator.py`). | **Real.** Live network traffic captured from the network interface (e.g., `eth0`). |
| **Suricata IDS** | **Mocked.** Reads from a fake log file. No actual packet inspection. | **Real.** Runs the `suricata` binary. Inspects real packets. |
| **ML Models** | **Mocked.** Uses random numbers and simple heuristics to generate scores. | **Real.** Loads TensorFlow/Keras models and runs actual inference on data. |
| **Requirements** | Minimal. Python only. No root privileges needed. | High. Requires Suricata installed, root privileges (`sudo`), and trained models. |
| **Purpose** | UI testing, presentations, verifying dashboard layout. | Actual network security monitoring. |

---

## 3. How Demo Mode Generates Fake Data

In Demo Mode, the system does **not** look at your network card. Instead, it uses a generator script:

1.  **Generator Script (`demo_data_generator.py`):**
    *   This script runs in the background.
    *   It contains a list of **templates** for "BENIGN" events (e.g., Google DNS, HTTPS) and "MALICIOUS" events (e.g., Reverse Shell, TOR connection).
    *   It randomly selects a template and fills in dynamic details like timestamps and ephemeral ports.
    *   It writes these fake events to a temporary file: `/tmp/demo_eve.json`.

2.  **Mock Engines:**
    *   **Mock ANN:** Reads `/tmp/demo_eve.json`. Instead of running a complex neural network, it looks at the event type. If it's an "alert" or uses a suspicious port (e.g., 4444), it assigns a high "malicious" score using `random.uniform(0.7, 0.95)`.
    *   **Mock Suricata:** Simply reformats the JSON lines from the generator into readable log lines.
    *   **Mock Hybrid:** Simulates the fusion formula. It generates random scores for Host and Stepping Stone components to match the production formula structure.

**Summary:** It's a closed loop of scripts writing to and reading from temporary files to simulate activity.

---

## 4. How Real Production Mode Generates Data

In Production Mode, the system analyzes **real-world traffic**:

1.  **Suricata (The Sensor):**
    *   The `suricata` process listens on your actual network interface (defined in `config.py`).
    *   It analyzes every packet passing through the interface.
    *   It generates a real-time log file: `/var/log/suricata/eve.json` (or similar path).

2.  **Stream Connection (`backend_scripts/stream_connection.py`):**
    *   This script tails the **real** `eve.json` file.
    *   **Feature Extraction:** It converts raw JSON events into numerical features (e.g., `pkts_toserver`, `bytes_toclient`, `flow_age`).
    *   **Scaling:** It applies mathematical scaling (StandardScaler) to match the format the AI model expects.
    *   **Inference:** It feeds these numbers into the actual trained TensorFlow model (`models/ann_model.h5`).
    *   **Result:** The model outputs a real prediction score based on the traffic patterns it learned during training.

**Summary:** Production mode connects to the physical network layer, processes real packets, and uses heavy computational models for analysis.
